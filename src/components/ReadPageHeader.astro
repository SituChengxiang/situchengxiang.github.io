---
import { toInteger } from "lodash-es";
import { slugify } from "@/utils/content";

interface Props {
  title: string;
  description?: string;
  category?: string;
  tags?: string[];
  imageUrl?: string;
  date?: string;
  lastMod?: string;
  words?: number;
  readingMinutes?: number;
}

const { title, category, tags, imageUrl, date, words, readingMinutes } =
  Astro.props;

const defaultImageUrl =
  imageUrl ||
  "https://bing.biturl.top/?resolution=UHD&format=image&index=0&mkt=zh-CN";
---

<div class="relative w-full h-[320px] md:h-[400px]">
  <div class="absolute inset-0 z-0">
    <div
      class="w-full h-full bg-cover bg-center bg-fixed"
      style={`background-image: url('${defaultImageUrl}');`}
    >
    </div>
    <div class="absolute inset-0 bg-black/30 dark:bg-black/40"></div>
    <div
      class="absolute inset-0 bg-gradient-to-b from-transparent to-black/70 dark:to-black/80"
    >
    </div>
  </div>

  <!-- 内容区域 - 简洁布局 -->
  <div class="relative z-10 h-full flex flex-col justify-end pb-16 md:pb-24">
    <div class="max-w-[1200px] mx-auto w-full px-4 md:px-8">
      <h1 class="text-4xl md:text-5xl font-bold text-white mb-4 drop-shadow-lg">
        {title}
      </h1>

      <div class="flex flex-wrap items-center gap-4 text-sm text-white/90">
        {
          category && (
            <span class="flex items-center gap-1">
              <i class="iconfont icon-hashtag" />
              {category}
            </span>
          )
        }
        {
          tags?.map((tag) => (
            <a
              class="flex items-center gap-1 hover:text-white transition-colors"
              href={`/tags/${slugify(tag)}`}
            >
              <i class="iconfont icon-hashtag" />
              {tag}
            </a>
          ))
        }
        {
          date && (
            <span class="flex items-center gap-1">
              <i class="iconfont icon-calendar" />
              {new Date(date).toLocaleDateString()}
            </span>
          )
        }
        {
          words && (
            <span class="flex items-center gap-1">
              <i class="iconfont icon-file-list" />
              {words} 字
            </span>
          )
        }
        {
          readingMinutes && (
            <span class="flex items-center gap-1">
              <i class="iconfont icon-timer" />
              {toInteger(readingMinutes)} 分钟
            </span>
          )
        }
      </div>
    </div>
  </div>

  <!-- 内容过渡锚点 - 纯色区域帮助眼睛过渡到阅读内容 -->
  <div
    class="absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-primary to-transparent z-20"
  >
  </div>
</div>
